# trace-demo
Spring Cloud Sleuth and Zipkin sample to demonstrate distributed tracing for Microservices

## Startup Steps
1) Install Zipkin
* See instructions from http://zipkin.io/pages/quickstart

* If you are using the default zipkin configuration the admin console will be
available at http://localhost:9411

2) The application consists of 4 SpringBoot applications 

* TraceDemoApplication - Frontend
* CartService - Cart Microservice
* CustomerService - Customer management Microservice
* OrderService - Order Microservice

This is a simulation of a sequence of microservices being called for a cart checkout process
1) The web application will submit a cart to initiate the checkout via the cartservice POST call
2) The cart service then initiates a call to the order service to place the order and gets back an order ID
3) The cart service then makes a subsequent call to the customer service to save the cart
4) The updated cart is returned with the order id and the cart status 

To run it from the command line execute the following steps on different command prompts

```
mvn spring-boot:run -Dmainclass=com.tfg.example.TraceDemoApplication
```
```
mvn spring-boot:run -Dmainclass=com.tfg.example.service.CartService
```
```
mvn spring-boot:run -Dmainclass=com.tfg.example.service.CustomerService
```
```
mvn spring-boot:run -Dmainclass=com.tfg.example.service.OrderService
```
Or use STS or IntelliJ to import the project and start each of these SpringBoot microservices

3) Use Postman or the browser and execute the following URL

http://localhost:8080/cart-checkout

The response will be something like the one mentioned below (where the orderID is randomly generated by the OrderService)
```
{
  "id": 1,
  "lineItem": [
    {
      "id": 1,
      "sku": "abc"
    }
  ],
  "orderId": "74493906-b46d-4155-aa1f-1c0c47c20260",
  "checkedOut": true
}
```
### Screen shots from Zipkin
![Screenshot 1](https://github.com/tsukhu/trace-demo/blob/master/screenshots/zipkin_output_1.PNG)

![Screenshot 2](https://github.com/tsukhu/trace-demo/blob/master/screenshots/zipkin_output_2.PNG)

![Screenshot 3](https://github.com/tsukhu/trace-demo/blob/master/screenshots/zipkin_output_3.PNG)

